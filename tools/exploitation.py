from core import SecurityTool, SecurityToolsCollection


class Metasploit(SecurityTool):
    TITLE = "Metasploit Framework"
    DESCRIPTION = "The world's most used penetration testing framework"
    INSTALL_COMMANDS = ["sudo apt-get install -y metasploit-framework"]
    RUN_COMMANDS = ["msfconsole"]
    PROJECT_URL = "https://www.metasploit.com"


class SQLMap(SecurityTool):
    TITLE = "SQLMap - SQL Injection Tool"
    DESCRIPTION = "Automatic SQL injection and database takeover tool"
    INSTALL_COMMANDS = [
        "git clone --depth 1 https://github.com/sqlmapproject/sqlmap.git"
    ]
    RUN_COMMANDS = ["cd sqlmap && python3 sqlmap.py -h"]
    PROJECT_URL = "https://github.com/sqlmapproject/sqlmap"


class ExploitDB(SecurityTool):
    TITLE = "SearchSploit - Exploit Database"
    DESCRIPTION = "Offline exploit database search tool"
    INSTALL_COMMANDS = ["sudo apt-get install -y exploitdb"]
    RUN_COMMANDS = ["searchsploit -h"]
    PROJECT_URL = "https://www.exploit-db.com"


class Commix(SecurityTool):
    TITLE = "Commix - Command Injection Exploiter"
    DESCRIPTION = "Automated command injection vulnerability testing and exploitation"
    INSTALL_COMMANDS = [
        "git clone https://github.com/commixproject/commix.git",
        "cd commix && pip3 install -r requirements.txt"
    ]
    RUN_COMMANDS = ["cd commix && python3 commix.py -h"]
    PROJECT_URL = "https://github.com/commixproject/commix"


class BeEF(SecurityTool):
    TITLE = "BeEF - Browser Exploitation Framework"
    DESCRIPTION = "The Browser Exploitation Framework Project"
    INSTALL_COMMANDS = ["sudo apt-get install -y beef-xss"]
    RUN_COMMANDS = ["beef-xss"]
    PROJECT_URL = "https://beefproject.com"


class ExploitationTools(SecurityToolsCollection):
    TITLE = "Exploitation & Vulnerability Tools"
    DESCRIPTION = "Powerful exploitation frameworks and vulnerability testing tools"
    TOOLS = [
        Metasploit(),
        SQLMap(),
        ExploitDB(),
        Commix(),
        BeEF()
    ]
